# 统计学：从数据到结论

## 1. 基本概念

统计学(statistics)是收集分析展示和解释数据的科学

常量(constant)和变量(variable)

定量变量或数量变量(quantitative variable)

定性变量、属性变量或分类变量(qualitative variable, categorical variable)

## 2. 数据的收集

观测数据(observational data)

试验数据(experimental data)

总体(population)或有限总体(finite population)

    包含所有要研究的个体的集合

样本(sample)

    总体中选出的一部分

简单随机抽样(simple random sampling)

    总体中每一个体都有同等机会被选到样本中

随机样本(random sample)

    简单随机抽样得到的样本

样本量(sample size)

收集数据时的误差

* 未响应误差(nonresponse error)
* 相应误差(response error)

抽样调查(sampling survey)

问卷(questionnaire)

概率抽样方法(probability sampling method)

* 系统抽样(systematic sampling)

* 分层抽样(stratified sampling)

* 整群抽样(cluster sampling)

* 多级抽样(multistage sampling)


非概率抽样方法(nonprobability sampling method)

* 目的抽样(purposive sample)

* 方便抽样(convenience sampling)

* 判断抽样(judgement sampling)

* 定额抽样(quota sampling)

* 雪球抽样(snowball sampling)

* 自我选择(self-selection)

样本空间(sampling space)

    所有和某个试验相关的基本事件的集合

样本点(sample point)

    任何不可分解的试验结果被一个而且仅仅被一个样本空间的点所代表


## 3. 数据的描述

### 3.1 如何用图来表示数据

* 直方图(histogram)

* 盒型图(boxplot)

    中位数

    上下四分位点

* 茎叶图(stem-and-leaft plots)

    前计算机时代的产物

* 散点图(scatter plot)

* 饼图(pie chart)

* 条形图(bar plot)

* Chernoff面孔图和星图(Chernoff Faces and star plot)

* Lorenz曲线

### 3.2 如何用少量数字来概括数据

summary statistic

样本均值(sample mean)

样本中位数(sample median)

第一四分位数(first quantile)

第三四分位数(third quantile)

尺度统计量

极差(range)

标准差(standard deviation)

    对于正态分布的数据，均值左右一个标准差的范围应该包含大约68%的观测值，而均值左右两个标准差的范围应该包含大约95%的观测值，均值左右三个标准差的范围应该会包含大约99.7%的观测值

interquantile range

样本标准差(standard deviation)

标准得分(standard score)

## 4. 机会的度量:概率和分布

### 4.1 得到概率的几种途径

* 利用等可能事件(equally likely event)

* 根据长期相对频数

    相对频数(relative frequency)

* 主观概率(subjective probability)

### 4.2 概率的运算

* 互补事件(complementary events)的概率

* 概率的加法

    互不相容的事件

* 概率的乘法

    贝叶斯公式

### 4.3 变量的分布

概率分布(probability distribution)

* 离散随机变量的分布

  * 二项分布(binomial distribution)
  
      B(n,p) or Bin(n,p)

  * 多项分布(multinomial distribution)

  * Poisson分布

    即泊松分布。衡量某种事件在一定期间出现的数目的概率。

    分布族： λ，事件出现数目的均值

  * 超几何分布(hypergeometric distribution)

    有限总体的不放回抽样

* 连续随机变量的分布

  连续变量(continuous variable)

  概率密度函数(probability density function,pdf)

  * 正态分布(normal distribution or Gaussian distribution)

    N(μ, σ^2)

    N(0,1) 标准正态分布

  * 卡方分布(chi-square distribution)

    n个独立标准正态变量的平方和称为有n个自由度的卡方分布

  * t分布(t-distribution)

    自由度=样本量-1
    大样本时可以用便准正态分布来近似t分布

  * F分布

    两个独立卡方分布的比称为F分布变量
    有两个自由度：第一个自由度等于分子上的卡方分布的自由度；第二个自由度等于在分母上的卡方分布的自由度

  * 均匀分布(uniform distribution)

* 累积分布函数(cumulative distribution function)

  随机变量小于或等于某个数值的概率P(X<=x)

### 4.4 抽样分布、中心极限定理

中心极限定理

    1. 样本均值X'的抽样分布的总体均值等于μ

    1. 样本均值X'的抽样分布的总体标准差等于σ/sqrt(n)

    1. 即使X的分布不是正态，在很一般的情况下，样本量增加时，X’的分布趋近于正态分布N(μ,σ/sqrt(n))

### 4.5 用小概率事件进行判断


## 5. 简单统计推断：总体参数的估计

统计推断(statistical inference)

    从数据得到关于总体参数的一些结论的过程

    估计和假设检验

### 5.1 用估计量估计总体参数

估计量(estimator)

    用于估计的统计量

实现(realization)或估计值(estimate)

    样本已经得到，把数据代入后，估计量就有了一个数值，也就不是随机的了，这个数字成为该估计量的一个实现

点估计(point estimation)和区间估计(interval estimation)

### 5.2 点估计

无偏估计量(unbiased estimator)

    虽然每个样本产生的估计量的不一定等于参数，但当抽取大量样本时，那些样本产生的估计量的均值会接近真正要估计的假定分布的参数。
    如果估计量的数学期望等于欲估计的总体参数，则该估计量称为该参数的无偏估计量

### 5.3 区间估计

总体比例p的置信度(confidence level)为95%的置信区间(confidence interval). 置信度又称置信水平或置信系数

* 一个正态总体均值μ的区间估计

```
> weight = scan("noodle.txt")
Read 48 items
> t.test(weight, con=0.95)$con
[1] 447.4124 450.6084
attr(,"conf.level")
[1] 0.95
> t.test(weight, con=0.95)

  One Sample t-test

data:  weight
t = 565.26, df = 47, p-value < 2.2e-16
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 447.4124 450.6084
sample estimates:
mean of x 
 449.0104
```

* 两个正态总体均值之差μ1-μ2的区间估计

```
> w=read.table("expend.txt",header=T)
> x=w[w[,2]==1,1]; y=w[w[,2]==2, 1]
> head(x)
[1] 5932 4464 5604 5043 4891 4180
> head(y)
[1] 7058 5261 6142 5982 6806 5570
> mean(x) -mean(y)
[1] -851.1928
> t.test(x,y)

  Welch Two Sample t-test

data:  x and y
t = -3.6161, df = 31.658, p-value = 0.001027
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -1330.8755  -371.5101
sample estimates:
mean of x mean of y 
 4562.529  5413.722 
```

* 总体比例(bernoulli试验成功概率)p的区间估计

```
> binom.test(934,1341,con=.95)$con
[1] 0.6711031 0.7210230
attr(,"conf.level")
[1] 0.95
```

* 总体比例(bernoulli试验成功概率)之差p1-p2的区间估计

两个地址调查对某商品的认可与否， 地区1被调查的950人里423人认可，地区2被调查的1102人里215人认可，两个总体比例之差p1-p2的95置信区间

```
> prop.test(c(423,215),c(950,1102),con=.95)$con
[1] 0.2098615 0.2904652
attr(,"conf.level")
[1] 0.95
```

### 5.4 关于置信区间的注意点

不能认为95%置信区间以0.95概率覆盖总体参数， 置信度95%仅仅描述用来构造该区上下界的统计量覆盖总体参数的概率，即无穷次重复抽样所得到的所有区间大约有95%包含参数。


## 6 简单统计推断：总体参数的假设检验

假设检验是一种方法，目的是为了判断一个关于总体特征的定量的判断的断言（假设）的真实性。人们通过从总体中抽出的随机样本来计算适当的统计量来检验一个假设。如果得到的统计量的实现值在假设为真时应该是罕见的（小概率事件），则有理由拒绝该假设

### 6.1 假设检验的过程和逻辑

零假设(null hypothesis)和备选假设(alternative hypothesis)并不对成

检验结果显著意味着有理由拒绝零假设，因此假设检验也被称为显著性检验(significant test)

没有足够的证据拒绝零假设，该检验不显著

在零假设下，检验统计量取其实现值及（沿着备选假设的方向)更加极端值的概率称为p值(p-value)

拒绝正确零假设的错误常被称为第一类错误(type I error), 犯第一类错误的概率可以认为等于p值，或者不大于事先设定的显著性水平α

备选假设正确时没能拒绝零假设的错误，称为第二类错误(type II error)

什么是小概率事件的标准，使用最多的标准是在零假设下根据样本所得的数据来拒绝零假设的概率应小于0.05，这种事先规定的概率称为显著性水平(significant level)

势

    检验的势就是当备选假设正确时，该检验拒绝零假设的概率，强势检验也称为高效率检验

p值又称观测的显著性水平(observed significant level)

* 前计算机时代发展的一些概念和步骤

  * 假设检验的逻辑步骤

    1. 写出零假设和备选假设
    1. 确定检验统计量
    1. 确定显著性水平α
    1. 根据数据计算检验统计量的实现值
    1. 得到检验是否显著的结论

  * 临界值

    作为概率的显著性水平的α实际上相应于一个检验统计量(T)取值范围的一个临界值(critical value)(tα),统计量取该值或更极端的值的概率等于α。
    统计量的实现值比临界值更极端等价于p值小于α
    统计量的实现值比临界值更极端的取值范围也称为拒绝域

### 6.2 关于正态总体均值的检验

单尾检验(one-tailed test)

双尾检验(two-tailed test)

正态性检查

  * Shapiro正态性检验(Shapiro-Wilk normality test)
  * 正太qq图
  * 非参数检验

### 6.3 关于比例的检验

### 6.4 非参数检验

检验没有假定总体分布的具体形式，这些检验根据数据观测值的相对大小建立统计量，然后找到在零假设下这些统计量的分布，并且看这些统计量的数据实现值是否在零假设下属于小概率事件。这种和数据本身的总体分布无关的检验称为非参数检验

比较检验的效率 , 渐进相对效率(ARE)

秩(rank)

    秩就是该数据按照升幂排列之后，每个观测值的位置

符号检验(sign test)

Wilcoxon符号秩检验(Wilcoxon signed-rank test)

   假设样本点来自连续对称总体分布

随机性的游程检验(runs test)

     检验一个取两个值的变量的这两个值的出现是否是随机的

     相同的0或1在一起称为一个游程(run),单独的0或1也算

比较两独立总体中位数的Wilcoxon(Mann-Whitney)秩和检验

    该拒绝而不能拒绝的检验方法是势(power)不足，或者效率(efficiency)低

## 7 变量之间的关系；回归和分类

### 7.1 问题的提出

Y 因变量或响应变量(dependent variable, response variable)

X 自变量或解释变量或协变量(independent varialbe, explanatory varialbe, coviriate)

回归和分类的区别在于因变量的性质。当因变量为数量变量时，叫做回归，而当因变量为定量变量时叫做分类

### 7.2 定量变量的线性相关

- Pearson相关系数(Pearson's correlation coefficient)

- Kendall相关系数

    非参数方法，即不依赖变量背后的分布

- Spearman秩相关系数(Spearman rank correlation coefficient )


### 7.3 经典回归和分类

最小二乘回归(least squares regression)

残差(residual)